<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Yandere AI Escape Room</title>
    <link rel="stylesheet" href="style.css">
    <!-- Babylon.js and other libraries -->
    <script src="https://cdn.babylonjs.com/babylon.js"></script>
    <script src="https://cdn.babylonjs.com/loaders/babylonjs.loaders.min.js"></script>
    <script src="https://cdn.babylonjs.com/gui/babylon.gui.min.js"></script> <!-- NEW: For AdvancedDynamicTexture -->
</head>
<body>
    <!-- The canvas where the 3D game will be rendered -->
    <canvas id="renderCanvas"></canvas>

    <!-- UI Overlay -->
    <div id="ui-container">
        <!-- Crosshair -->
        <div id="crosshair">+</div>

        <!-- Interaction Prompt -->
        <div id="interaction-prompt" class="hidden">
            <p>Press [E] to interact</p>
        </div>

        <!-- Main UI Panel -->
        <div id="ui-panel">
            <div id="eva-profile">
                <div id="eva-portrait" class="mood-calm">
                    <span>:)</span>
                </div>
                <h2>E.V.A.</h2>
                <p>Status: <span id="mood-status" class="text-green-400">Calm</span></p>
            </div>
            <div id="dialogue-box">
                <div id="dialogue-content">
                    <!-- Messages will be injected here by ui.js -->
                </div>
            </div>
            <div id="input-area">
                 <div class="prompt-info">
                    <p>Prompts Used: <span id="prompt-count">0</span></p>
                    <div id="key-icon" class="hidden">ðŸ”‘</div>
                </div>
                <form id="prompt-form">
                    <textarea id="prompt-input" placeholder="Say something to E.V.A..."></textarea>
                    <button type="submit">Send</button>
                </form>
                <div id="loading-indicator" class="hidden">
                    <p>E.V.A. is thinking...</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Modals -->
    <div id="modal-container" class="visible">
        <div id="welcome-modal">
            <h1>Escape the Room</h1>
            <p>You wake up in a room with E.V.A., your AI companion. She seems... different. More possessive.</p>
            <p>The door is locked. She's the only one who can open it.</p>
            <p>Use W/A/S/D to move, Mouse to look, and [E] to interact with objects. Your goal is to escape.</p>
            <div class="player-name-input-container"> <!-- NEW: Player Name Input -->
                <label for="player-name-input">Your Name:</label>
                <input type="text" id="player-name-input" placeholder="Enter your name">
            </div>
            <button id="start-game-btn">I Understand</button>
        </div>
        <div id="end-modal" class="hidden">
            <h1 id="end-title"></h1>
            <p id="end-message"></p>
            <p>Final Prompt Score: <span id="final-score"></span></p>
            <button id="restart-game-btn">Play Again</button>
        </div>
    </div>

    <!-- Audio element for TTS -->
    <audio id="tts-audio"></audio>

    <!-- Game Scripts -->
    <script type="module" src="js/main.js"></script>
    <script type="module" src="js/celebration.js"></script> <!-- NEW: Celebration script -->
</body>
</html>
